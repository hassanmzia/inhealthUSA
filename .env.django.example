# ============================================================================
# InHealth EHR - Enterprise Authentication Configuration Template
# ============================================================================
# Copy this file to .env and fill in your values
# NEVER commit the actual .env file to version control!
# ============================================================================

# ============================================================================
# GENERAL DJANGO SETTINGS
# ============================================================================
SECRET_KEY=your-secret-key-here-change-in-production
DEBUG=False
ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DB_NAME=inhealth_db
DB_USER=inhealth_user
DB_PASSWORD=your-database-password
DB_HOST=localhost
DB_PORT=5432

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@example.com
EMAIL_HOST_PASSWORD=your-email-password
DEFAULT_FROM_EMAIL=noreply@inhealthehr.com

# ============================================================================
# TWILIO SMS CONFIGURATION (for MFA and Vital Alerts)
# ============================================================================
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# GOOGLE reCAPTCHA
# ============================================================================
# Get keys from: https://www.google.com/recaptcha/admin
RECAPTCHA_PUBLIC_KEY=your-recaptcha-public-key
RECAPTCHA_PRIVATE_KEY=your-recaptcha-private-key

# ============================================================================
# AZURE ACTIVE DIRECTORY (OIDC) CONFIGURATION
# ============================================================================
# Register app in Azure Portal: https://portal.azure.com
# Navigate to: Azure Active Directory > App registrations > New registration

# Your Azure AD Tenant ID
AZURE_AD_TENANT_ID=your-tenant-id

# Application (client) ID
AZURE_AD_CLIENT_ID=your-client-id

# Client Secret
AZURE_AD_CLIENT_SECRET=your-client-secret

# Constructed endpoints
AZURE_AD_AUTHORIZATION_ENDPOINT=https://login.microsoftonline.com/your-tenant-id/oauth2/v2.0/authorize
AZURE_AD_TOKEN_ENDPOINT=https://login.microsoftonline.com/your-tenant-id/oauth2/v2.0/token
AZURE_AD_USER_ENDPOINT=https://graph.microsoft.com/v1.0/me
AZURE_AD_JWKS_ENDPOINT=https://login.microsoftonline.com/your-tenant-id/discovery/v2.0/keys

# ============================================================================
# OKTA CONFIGURATION
# ============================================================================
OKTA_ENABLED=False
OKTA_ORG_URL=https://your-org.okta.com
OKTA_CLIENT_ID=your-okta-client-id
OKTA_CLIENT_SECRET=your-okta-client-secret
OKTA_ISSUER=https://your-org.okta.com/oauth2/default

# ============================================================================
# AWS COGNITO CONFIGURATION
# ============================================================================
AWS_COGNITO_ENABLED=False
AWS_COGNITO_REGION=us-east-1
AWS_COGNITO_USER_POOL_ID=us-east-1_XXXXXXXXX
AWS_COGNITO_APP_CLIENT_ID=your-app-client-id
AWS_COGNITO_APP_CLIENT_SECRET=your-app-client-secret
AWS_COGNITO_DOMAIN=your-cognito-domain.auth.us-east-1.amazoncognito.com

# ============================================================================
# SAML 2.0 CONFIGURATION
# ============================================================================
SAML_ENABLED=False
SAML_SP_ENTITY_ID=https://your-app.com/saml/metadata/
SAML_SP_ACS_URL=https://your-app.com/saml/acs/
SAML_SP_SLS_URL=https://your-app.com/saml/sls/
SAML_IDP_METADATA_URL=https://your-idp.com/metadata.xml
SAML_IDP_ENTITY_ID=https://your-idp.com
SAML_IDP_SSO_URL=https://your-idp.com/sso
SAML_IDP_X509_CERT=

# ============================================================================
# CAC (COMMON ACCESS CARD) / PKI AUTHENTICATION
# ============================================================================
CAC_ENABLED=False
CAC_REQUIRE_CERT_FOR_LOGIN=False
CAC_CLIENT_CERT_HEADER=HTTP_X_SSL_CLIENT_CERT
CAC_CLIENT_DN_HEADER=HTTP_X_SSL_CLIENT_S_DN
CAC_ISSUER_DN_HEADER=HTTP_X_SSL_CLIENT_I_DN
CAC_CERT_AUTHORITY_CERT_PATH=/etc/ssl/certs/dod_ca_bundle.pem

# ============================================================================
# MICROSOFT ACTIVE DIRECTORY (LDAP) - Optional
# ============================================================================
AD_ENABLED=False
AUTH_LDAP_SERVER_URI=ldap://ad.example.com
AUTH_LDAP_BIND_DN=CN=ServiceAccount,OU=Service Accounts,DC=example,DC=com
AUTH_LDAP_BIND_PASSWORD=service-account-password
AUTH_LDAP_USER_SEARCH_BASE=ou=users,dc=example,dc=com

# ============================================================================
# SESSION SECURITY SETTINGS
# ============================================================================
SESSION_COOKIE_AGE=28800
SESSION_EXPIRE_AT_BROWSER_CLOSE=False

# ============================================================================
# MULTI-FACTOR AUTHENTICATION (MFA) SETTINGS
# ============================================================================
MFA_ENABLED=True
MFA_REQUIRED_FOR_STAFF=True
MFA_REQUIRED_FOR_SUPERUSER=True
MFA_GRACE_PERIOD_DAYS=7
OTP_TOTP_ISSUER=InHealth EHR

# ============================================================================
# FAILED LOGIN PROTECTION (django-axes)
# ============================================================================
AXES_FAILURE_LIMIT=5
AXES_COOLOFF_TIME=1
