{% extends 'healthcare/base.html' %}

{% block title %}Archive {{ archive_date }} - IoT File Manager{% endblock %}

{% block content %}
<div class="breadcrumbs">
    <a href="{% url 'index' %}">Home</a> &rsaquo;
    <a href="{% url 'admin_dashboard' %}">Admin Dashboard</a> &rsaquo;
    <a href="{% url 'iot_file_manager' %}">IoT File Manager</a> &rsaquo;
    Archive {{ archive_date }}
</div>

<div class="module">
    <h1>Archive: {{ archive_date }}</h1>
    <p>Viewing {{ file_count }} file{{ file_count|pluralize }} processed on {{ archive_date }}</p>

    <div style="margin: 20px 0;">
        <a href="{% url 'iot_file_manager' %}" class="button" style="background: #417690; color: white; padding: 10px 20px; text-decoration: none; border-radius: 3px;">
            &larr; Back to File Manager
        </a>
    </div>

    {% if archive_files %}
    <table style="width: 100%; margin-top: 20px; border-collapse: collapse;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="padding: 10px; text-align: left;">Filename</th>
                <th style="padding: 10px; text-align: left;">Size</th>
                <th style="padding: 10px; text-align: left;">Modified</th>
                <th style="padding: 10px; text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for file in archive_files %}
            <tr style="border-bottom: 1px solid #e8e8e8;">
                <td style="padding: 10px;">
                    <a href="{% url 'iot_view_file' archive_date file.name %}" style="color: #417690; text-decoration: none;">
                        {{ file.name }}
                    </a>
                </td>
                <td style="padding: 10px;">{{ file.size|filesizeformat }}</td>
                <td style="padding: 10px;">{{ file.modified|date:"M d, Y H:i:s" }}</td>
                <td style="padding: 10px; text-align: center;">
                    <a href="{% url 'iot_view_file' archive_date file.name %}" class="button" style="font-size: 12px; padding: 5px 10px; background: #417690; color: white; text-decoration: none; border-radius: 3px; margin-right: 5px;">
                        View
                    </a>
                    <a href="{% url 'iot_download_file' archive_date file.name %}" class="button" style="font-size: 12px; padding: 5px 10px; background: #4caf50; color: white; text-decoration: none; border-radius: 3px; margin-right: 5px;">
                        Download
                    </a>
                    <form method="post" action="{% url 'iot_delete_file' archive_date file.name %}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this file?');">
                        {% csrf_token %}
                        <button type="submit" class="button" style="font-size: 12px; padding: 5px 10px; background: #f44336; color: white; border: none; border-radius: 3px; cursor: pointer;">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="margin-top: 15px; padding: 20px; background: #f9f9f9; text-align: center; color: #999;">
        No files found in this archive
    </p>
    {% endif %}
</div>
{% endblock %}
