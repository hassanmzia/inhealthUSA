{% extends 'healthcare/base.html' %}

{% block title %}Appointments - InHealth EHR{% endblock %}

{% block breadcrumbs %}
&rsaquo; <a href="{% url 'appointment_list' %}">Appointments</a>
{% endblock %}

{% block content %}
<h1>Appointments</h1>

<!-- Filter -->
<div class="search-form">
    <form method="get" action="{% url 'appointment_list' %}">
        <label for="status" style="margin-right: 10px;">Filter by Status:</label>
        <select name="status" id="status">
            <option value="">All Statuses</option>
            <option value="Scheduled" {% if status == 'Scheduled' %}selected{% endif %}>Scheduled</option>
            <option value="Checked In" {% if status == 'Checked In' %}selected{% endif %}>Checked In</option>
            <option value="In Progress" {% if status == 'In Progress' %}selected{% endif %}>In Progress</option>
            <option value="Completed" {% if status == 'Completed' %}selected{% endif %}>Completed</option>
            <option value="Cancelled" {% if status == 'Cancelled' %}selected{% endif %}>Cancelled</option>
            <option value="No Show" {% if status == 'No Show' %}selected{% endif %}>No Show</option>
        </select>
        <button type="submit">Filter</button>
    </form>
</div>

<!-- Appointment List -->
<div class="module">
    <table>
        <caption>Appointment List</caption>
        <thead>
            <tr>
                <th>Date & Time</th>
                <th>Patient</th>
                <th>Physician</th>
                <th>Type</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for appointment in appointments %}
            <tr>
                <td>{{ appointment.encounter_date|date:"Y-m-d H:i" }}</td>
                <td>
                    <a href="{% url 'patient_detail' appointment.patient.patient_id %}">
                        {{ appointment.patient.full_name }}
                    </a>
                </td>
                <td>
                    {% if appointment.provider %}
                        Dr. {{ appointment.provider.full_name }}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>{{ appointment.encounter_type }}</td>
                <td>
                    <span class="status-badge status-{{ appointment.status|lower|cut:' ' }}">
                        {{ appointment.status }}
                    </span>
                </td>
                <td>
                    <a href="{% url 'appointment_detail' appointment.encounter_id %}">View</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" style="text-align: center; color: #666;">
                    No appointments found.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<p style="margin-top: 20px; font-size: 12px; color: #666;">
    <strong>Note:</strong> To add or edit appointments, please use the <a href="/admin/healthcare/encounter/">Admin Panel</a>.
</p>
{% endblock %}
