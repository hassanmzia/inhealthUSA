{% extends 'healthcare/base.html' %}
{% block title %}Family History Details - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; <a href="{% url 'family_history_list' %}">Family History</a> &rsaquo; {{ history.relationship }} - {{ history.condition }}{% endblock %}
{% block content %}
<style>
    .detail-header { background: white; border: 1px solid var(--hairline-color); border-radius: 4px; padding: 20px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
    .detail-header h1 { margin: 0 0 8px 0; font-size: 28px; font-weight: 300; }
    .detail-header .meta { font-size: 13px; color: #666; }
    .detail-header .actions { display: flex; gap: 10px; }
    .info-module { background: white; border: 1px solid var(--hairline-color); border-radius: 4px; margin-bottom: 20px; overflow: hidden; }
    .info-module h2 { margin: 0; padding: 12px 20px; font-weight: 500; font-size: 15px; background: var(--primary); color: var(--header-link-color); }
    .info-module dl { margin: 0; }
    .info-module dl > div { display: grid; grid-template-columns: 200px 1fr; gap: 20px; padding: 12px 20px; border-bottom: 1px solid var(--hairline-color); }
    .info-module dl > div:nth-child(even) { background: var(--darkened-bg); }
    .info-module dl > div:last-child { border-bottom: none; }
    .info-module dt { font-size: 13px; font-weight: 600; color: #666; }
    .info-module dd { font-size: 13px; color: var(--body-fg); margin: 0; }
    .relationship-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 500; background: #d1ecf1; color: #0c5460; }
    .status-indicator { display: inline-flex; align-items: center; gap: 8px; padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; }
    .status-indicator.alive { background: #d4edda; color: #155724; }
    .status-indicator.deceased { background: #e2e3e5; color: #383d41; }
    .status-indicator::before { content: ''; display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: currentColor; }
</style>

<div class="detail-header">
    <div>
        <h1>{{ history.relationship }} - {{ history.condition }}</h1>
        <div class="meta"><strong>Patient:</strong> <a href="{% url 'patient_detail' history.patient.patient_id %}" style="color: var(--link-fg);">{{ history.patient.full_name }}</a> | <strong>History ID:</strong> {{ history.family_history_id }}</div>
    </div>
    <div class="actions">
        <a href="{% url 'patient_detail' history.patient.patient_id %}" class="button button-secondary">View Patient</a>
        <a href="/admin/healthcare/familyhistory/{{ history.family_history_id }}/change/" class="button">Edit Record</a>
    </div>
</div>

<div class="info-module">
    <h2>Family History Information</h2>
    <dl>
        <div><dt>Patient</dt><dd><a href="{% url 'patient_detail' history.patient.patient_id %}" style="color: var(--link-fg); font-weight: 600;">{{ history.patient.full_name }}</a></dd></div>
        <div><dt>Relationship</dt><dd><span class="relationship-badge">{{ history.relationship }}</span></dd></div>
        <div><dt>Condition</dt><dd><strong>{{ history.condition }}</strong></dd></div>
        <div><dt>Age at Diagnosis</dt><dd>{% if history.age_at_diagnosis %}{{ history.age_at_diagnosis }} years old{% else %}—{% endif %}</dd></div>
        <div><dt>Status</dt><dd>
            <span class="status-indicator {% if history.is_alive %}alive{% else %}deceased{% endif %}">
                {% if history.is_alive %}Living{% else %}Deceased{% endif %}
            </span>
        </dd></div>
        {% if not history.is_alive %}
        <div><dt>Age at Death</dt><dd>{% if history.age_at_death %}{{ history.age_at_death }} years old{% else %}—{% endif %}</dd></div>
        <div><dt>Cause of Death</dt><dd>{{ history.cause_of_death|default:"—" }}</dd></div>
        {% endif %}
        <div><dt>Recorded Date</dt><dd>{{ history.recorded_date|date:"F d, Y" }}</dd></div>
        {% if history.notes %}<div><dt>Notes</dt><dd>{{ history.notes }}</dd></div>{% endif %}
    </dl>
</div>

<p style="margin-top: 20px; font-size: 12px; color: #666;"><strong>Note:</strong> Use the <a href="/admin/healthcare/familyhistory/{{ history.family_history_id }}/change/">Django Admin Panel</a> to edit family history details.</p>
{% endblock %}
