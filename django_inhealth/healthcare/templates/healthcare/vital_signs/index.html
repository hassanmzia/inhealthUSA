{% extends 'healthcare/base.html' %}
{% block title %}Vital Signs - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; Vital Signs{% endblock %}
{% block content %}
<style>
    .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .page-header h1 { margin: 0; font-size: 28px; font-weight: 300; }
    .filter-form { background: white; padding: 15px; margin-bottom: 20px; border: 1px solid var(--hairline-color); border-radius: 4px; }
    .filter-form form { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .filter-form input[type="text"] { flex: 1; min-width: 250px; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 4px; font-size: 14px; }
    .data-module { background: white; border: 1px solid var(--hairline-color); border-radius: 4px; overflow: hidden; }
    .data-module table { width: 100%; border-collapse: collapse; }
    .data-module caption { background: var(--primary); color: var(--header-link-color); padding: 12px 15px; text-align: left; font-weight: 500; font-size: 15px; }
    .data-module thead { background: var(--darkened-bg); }
    .data-module thead th { padding: 10px 15px; text-align: left; font-size: 11px; font-weight: 600; text-transform: uppercase; border-bottom: 1px solid var(--hairline-color); }
    .data-module tbody td { padding: 12px 15px; border-bottom: 1px solid var(--hairline-color); font-size: 13px; }
    .data-module tbody tr:hover { background: var(--darkened-bg); }
    .patient-link { color: var(--link-fg); font-weight: 500; }
    .vital-value { font-weight: 600; }
    .empty-state { text-align: center; padding: 60px 20px; color: #999; }
    .empty-state svg { width: 80px; height: 80px; margin: 0 auto 20px; opacity: 0.3; }
    .stats-bar { background: white; border: 1px solid var(--hairline-color); border-radius: 4px; padding: 15px 20px; margin-bottom: 20px; display: flex; justify-content: space-around; }
    .stat-item { text-align: center; }
    .stat-value { font-size: 24px; font-weight: 600; color: var(--primary); }
    .stat-label { font-size: 12px; color: #666; text-transform: uppercase; letter-spacing: 0.5px; }
</style>

<div class="page-header">
    <h1>Vital Signs</h1>
    <div><a href="/admin/healthcare/vitalsign/add/" class="button">+ Record Vitals</a></div>
</div>

<div class="stats-bar">
    <div class="stat-item"><div class="stat-value">{{ vital_signs|length }}</div><div class="stat-label">Total Records</div></div>
</div>

<div class="filter-form">
    <form method="get">
        <input type="text" name="search" value="{{ search }}" placeholder="Search by patient name or encounter...">
        <button type="submit" class="button">Search</button>
        {% if search %}<a href="{% url 'vital_sign_list' %}" class="button button-secondary">Clear</a>{% endif %}
    </form>
</div>

<div class="data-module">
    <table>
        <caption>{% if search %}Search Results for "{{ search }}"{% else %}All Vital Signs{% endif %}</caption>
        <thead>
            <tr><th>Vitals ID</th><th>Patient</th><th>Blood Pressure</th><th>Heart Rate</th><th>Temperature</th><th>Resp. Rate</th><th>O2 Sat</th><th>Recorded At</th><th>Actions</th></tr>
        </thead>
        <tbody>
            {% for vital in vital_signs %}
            <tr>
                <td><strong>{{ vital.vital_signs_id }}</strong></td>
                <td><a href="{% url 'patient_detail' vital.encounter.patient.patient_id %}" class="patient-link">{{ vital.encounter.patient.full_name }}</a></td>
                <td><span class="vital-value">{{ vital.blood_pressure|default:"—" }}</span></td>
                <td>{% if vital.heart_rate %}<span class="vital-value">{{ vital.heart_rate }}</span> bpm{% else %}—{% endif %}</td>
                <td>{% if vital.temperature_value %}<span class="vital-value">{{ vital.temperature_value }}°{{ vital.temperature_unit }}</span>{% else %}—{% endif %}</td>
                <td>{% if vital.respiratory_rate %}<span class="vital-value">{{ vital.respiratory_rate }}</span> /min{% else %}—{% endif %}</td>
                <td>{% if vital.oxygen_saturation %}<span class="vital-value">{{ vital.oxygen_saturation }}%</span>{% else %}—{% endif %}</td>
                <td>{{ vital.recorded_at|date:"M d, Y g:i A" }}</td>
                <td><a href="{% url 'vital_sign_detail' vital.vital_signs_id %}" style="color: var(--link-fg); font-weight: 500;">View</a></td>
            </tr>
            {% empty %}
            <tr><td colspan="9"><div class="empty-state"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg><p>{% if search %}No vital signs found matching "{{ search }}"{% else %}No vital signs recorded yet{% endif %}</p></div></td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<p style="margin-top: 20px; font-size: 12px; color: #666;"><strong>Tip:</strong> Use the <a href="/admin/healthcare/vitalsign/">Django Admin Panel</a> for advanced management operations.</p>
{% endblock %}
