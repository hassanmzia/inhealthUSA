{% extends 'healthcare/base.html' %}

{% block title %}Patients - InHealth EHR{% endblock %}

{% block breadcrumbs %}
&rsaquo; <a href="{% url 'patient_list' %}">Patients</a>
{% endblock %}

{% block content %}
<h1>Patients</h1>

<!-- Search -->
<div class="search-form">
    <form method="get" action="{% url 'patient_list' %}">
        <input type="text" name="search" value="{{ search }}" placeholder="Search patients by name, email, or phone...">
        <button type="submit">Search</button>
    </form>
</div>

<!-- Patient List -->
<div class="module">
    <table>
        <caption>Patient List</caption>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Primary Doctor</th>
                <th>Hospital</th>
                <th>DOB</th>
                <th>Phone</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for patient in patients %}
            <tr>
                <td>{{ patient.patient_id }}</td>
                <td>
                    <a href="{% url 'patient_detail' patient.patient_id %}">
                        {{ patient.full_name }}
                    </a>
                </td>
                <td>
                    {% if patient.primary_doctor %}
                        <a href="{% url 'physician_detail' patient.primary_doctor.provider_id %}">
                            Dr. {{ patient.primary_doctor.full_name }}
                        </a>
                    {% else %}
                        <span style="color: #999;">Not assigned</span>
                    {% endif %}
                </td>
                <td>
                    {% if patient.primary_doctor.hospital %}
                        <a href="{% url 'hospital_detail' patient.primary_doctor.hospital.hospital_id %}">
                            {{ patient.primary_doctor.hospital.name }}
                        </a>
                    {% else %}
                        <span style="color: #999;">N/A</span>
                    {% endif %}
                </td>
                <td>{{ patient.date_of_birth|date:"Y-m-d" }}</td>
                <td>{{ patient.phone|default:"N/A" }}</td>
                <td>
                    <a href="{% url 'patient_detail' patient.patient_id %}">View</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" style="text-align: center; color: #666;">
                    No patients found.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<p style="margin-top: 20px; font-size: 12px; color: #666;">
    <strong>Note:</strong> To add or edit patients, please use the <a href="/admin/healthcare/patient/">Admin Panel</a>.
</p>
{% endblock %}
