{% extends 'healthcare/base.html' %}

{% block title %}Add Vital Signs - InHealth EHR{% endblock %}

{% block breadcrumbs %}
&rsaquo; <a href="{% url 'patient_list' %}">Patients</a>
&rsaquo; <a href="{% url 'patient_detail' patient.patient_id %}">{{ patient.full_name }}</a>
&rsaquo; <a href="{% url 'patient_edit' patient.patient_id %}">Edit</a>
&rsaquo; Add Vital Signs
{% endblock %}

{% block content %}
{% include 'healthcare/includes/form_styles.html' %}

<div class="form-container">
    <div class="form-header">
        <h1>Add Vital Signs</h1>
        <div class="meta"><strong>Patient:</strong> {{ patient.full_name }} ({{ patient.patient_id }})</div>
    </div>

    <div class="module form-module">
        <h2>Vital Signs Information</h2>
        <div class="form-content">
            <form method="POST">
                {% csrf_token %}

                <div class="form-row full-width">
                    <div class="form-group">
                        <label>Provider</label>
                        <select name="provider_id">
                            <option value="">Select Provider</option>
                            {% for provider in providers %}
                            <option value="{{ provider.provider_id }}">Dr. {{ provider.full_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="form-row full-width">
                    <div class="form-group">
                        <label>Link to Encounter (Optional)</label>
                        <select name="encounter_id">
                            <option value="">Create New Encounter</option>
                            {% for encounter in encounters %}
                            <option value="{{ encounter.encounter_id }}">{{ encounter.encounter_date|date:"M d, Y H:i" }} - {{ encounter.encounter_type }}</option>
                            {% endfor %}
                        </select>
                        <span class="help-text">Leave blank to create a new encounter</span>
                    </div>
                </div>

                <div class="section-divider"></div>
                <h3 class="section-title">Basic Measurements</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label>Temperature</label>
                        <div class="input-group">
                            <input type="number" step="0.1" name="temperature_value" placeholder="98.6">
                            <select name="temperature_unit">
                                <option value="F" selected>°F</option>
                                <option value="C">°C</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Blood Pressure</label>
                        <div class="input-group-split">
                            <input type="number" name="blood_pressure_systolic" placeholder="Systolic">
                            <input type="number" name="blood_pressure_diastolic" placeholder="Diastolic">
                        </div>
                        <span class="help-text">e.g., 120/80 mmHg</span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Heart Rate</label>
                        <input type="number" name="heart_rate" placeholder="72">
                        <span class="help-text">beats per minute (bpm)</span>
                    </div>

                    <div class="form-group">
                        <label>Respiratory Rate</label>
                        <input type="number" name="respiratory_rate" placeholder="16">
                        <span class="help-text">breaths per minute</span>
                    </div>

                    <div class="form-group">
                        <label>Oxygen Saturation</label>
                        <input type="number" step="0.1" name="oxygen_saturation" placeholder="98">
                        <span class="help-text">percentage (%)</span>
                    </div>
                </div>

                <div class="section-divider"></div>
                <h3 class="section-title">Body Measurements</h3>

                <div class="form-row three-col">
                    <div class="form-group">
                        <label>Weight</label>
                        <div class="input-group">
                            <input type="number" step="0.1" name="weight_value" placeholder="150">
                            <select name="weight_unit">
                                <option value="lbs" selected>lbs</option>
                                <option value="kg">kg</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Height</label>
                        <div class="input-group">
                            <input type="number" step="0.1" name="height_value" placeholder="68">
                            <select name="height_unit">
                                <option value="in" selected>in</option>
                                <option value="cm">cm</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>BMI</label>
                        <input type="number" step="0.1" name="bmi" placeholder="24.5">
                        <span class="help-text">Body Mass Index</span>
                    </div>
                </div>

                <div class="form-row full-width">
                    <div class="form-group">
                        <label>Notes</label>
                        <textarea name="notes" rows="3" placeholder="Additional observations or notes"></textarea>
                    </div>
                </div>

                <div class="submit-row">
                    <div></div>
                    <div class="buttons-right">
                        <a href="{% url 'patient_edit' patient.patient_id %}" class="button-secondary">Cancel</a>
                        <button type="submit" class="button-primary">Save Vital Signs</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
