{% extends 'healthcare/base.html' %}
{% block title %}Edit Lab Test - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; <a href="{% url 'patient_list' %}">Patients</a> &rsaquo; <a href="{% url 'patient_detail' patient.patient_id %}">{{ patient.full_name }}</a> &rsaquo; <a href="{% url 'patient_edit' patient.patient_id %}">Edit</a> &rsaquo; Edit Lab Test{% endblock %}
{% block content %}{% include 'healthcare/includes/form_styles.html' %}<div class="form-container"><div class="form-header"><h1>Edit Laboratory Test</h1><div class="meta"><strong>Patient:</strong> {{ patient.full_name }} | <strong>Test:</strong> {{ lab_test.test_name }}</div></div><div class="module form-module"><h2>Lab Test Order</h2><div class="form-content"><form method="POST">{% csrf_token %}<h3 class="section-title">Test Information</h3><div class="form-row"><div class="form-group"><label class="required">Test Name</label><input type="text" name="test_name" value="{{ lab_test.test_name }}" required></div><div class="form-group"><label>Test Code</label><input type="text" name="test_code" value="{{ lab_test.test_code|default:'' }}"></div></div><div class="form-row"><div class="form-group"><label>Ordering Provider</label><select name="ordered_by"><option value="">Select Provider</option>{% for provider in providers %}<option value="{{ provider.provider_id }}" {% if lab_test.ordered_by_id == provider.provider_id %}selected{% endif %}>Dr. {{ provider.full_name }}</option>{% endfor %}</select></div><div class="form-group"><label class="required">Ordered Date</label><input type="date" name="ordered_date" value="{{ lab_test.ordered_date|date:'Y-m-d' }}" required></div></div><div class="section-divider"></div><h3 class="section-title">Test Status & Results</h3><div class="form-row"><div class="form-group"><label>Status</label><select name="status"><option value="Ordered" {% if lab_test.status == 'Ordered' %}selected{% endif %}>Ordered</option><option value="Collected" {% if lab_test.status == 'Collected' %}selected{% endif %}>Collected</option><option value="In Progress" {% if lab_test.status == 'In Progress' %}selected{% endif %}>In Progress</option><option value="Completed" {% if lab_test.status == 'Completed' %}selected{% endif %}>Completed</option><option value="Cancelled" {% if lab_test.status == 'Cancelled' %}selected{% endif %}>Cancelled</option></select></div><div class="form-group"><label>Collection Date</label><input type="date" name="collection_date" value="{% if lab_test.collection_date %}{{ lab_test.collection_date|date:'Y-m-d' }}{% endif %}"></div><div class="form-group"><label>Result Date</label><input type="date" name="result_date" value="{% if lab_test.result_date %}{{ lab_test.result_date|date:'Y-m-d' }}{% endif %}"></div></div><div class="form-row"><div class="form-group"><label>Reference Range</label><input type="text" name="reference_range" value="{{ lab_test.reference_range|default:'' }}"></div><div class="form-group"><label>Unit</label><input type="text" name="unit" value="{{ lab_test.unit|default:'' }}"></div></div><div class="form-row full-width"><div class="form-group"><label>Result</label><textarea name="result" rows="3">{{ lab_test.result|default:'' }}</textarea></div></div><div class="form-row full-width"><div class="form-group"><label>Notes</label><textarea name="notes" rows="3">{{ lab_test.notes|default:'' }}</textarea></div></div><div class="submit-row"><div></div><div class="buttons-right"><a href="{% url 'patient_edit' patient.patient_id %}" class="button-secondary">Cancel</a><button type="submit" class="button-primary">Update Lab Test</button></div></div></form></div></div></div>{% endblock %}
