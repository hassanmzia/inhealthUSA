{% extends 'healthcare/base.html' %}
{% block title %}{{ patient.full_name }} - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; <a href="{% url 'patient_list' %}">Patients</a> &rsaquo; {{ patient.full_name }}{% endblock %}
{% block content %}<style>.detail-header{background:white;border:1px solid var(--hairline-color);border-radius:4px;padding:20px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.detail-header h1{margin:0;font-size:28px;font-weight:300}.detail-header .meta{font-size:13px;color:#666;margin-top:8px}.detail-header .actions{display:flex;gap:10px}.quick-access-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:20px}.quick-card{background:linear-gradient(135deg,var(--primary-from,#3b82f6) 0%,var(--primary-to,#2563eb) 100%);border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:all 0.2s ease;text-decoration:none;color:white;position:relative;overflow:hidden}.quick-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.15)}.quick-card.blue{--primary-from:#3b82f6;--primary-to:#2563eb}.quick-card.green{--primary-from:#10b981;--primary-to:#059669}.quick-card.purple{--primary-from:#8b5cf6;--primary-to:#7c3aed}.quick-card.indigo{--primary-from:#6366f1;--primary-to:#4f46e5}.quick-card.pink{--primary-from:#ec4899;--primary-to:#db2777}.quick-card-title{font-size:16px;font-weight:600;margin:8px 0 4px;color:white}.quick-card-desc{font-size:13px;opacity:0.9;color:white}.quick-card-icon{width:32px;height:32px;background:rgba(255,255,255,0.2);border-radius:8px;display:flex;align-items:center;justify-content:center;margin-bottom:8px}.quick-card-badge{position:absolute;top:12px;right:12px;background:#ef4444;color:white;border-radius:12px;padding:2px 8px;font-size:11px;font-weight:700}.info-module{background:white;border:1px solid var(--hairline-color);border-radius:4px;margin-bottom:20px;overflow:hidden}.info-module h2{margin:0;padding:12px 20px;font-weight:500;font-size:15px;background:var(--primary);color:var(--header-link-color)}.info-module .content{padding:0}.info-module dl{margin:0}.info-module dl>div{display:grid;grid-template-columns:200px 1fr;gap:20px;padding:12px 20px;border-bottom:1px solid var(--hairline-color)}.info-module dl>div:nth-child(even){background:var(--darkened-bg)}.info-module dl>div:last-child{border-bottom:none}.info-module dt{font-size:13px;font-weight:600;color:#666}.info-module dd{font-size:13px;color:var(--body-fg);margin:0}.badge-list{display:flex;flex-wrap:wrap;gap:8px;margin:0;padding:15px 20px}.badge-item{display:inline-block;padding:6px 12px;border-radius:12px;font-size:12px;font-weight:600}.badge-severe{background:#f8d7da;color:#721c24}.badge-moderate{background:#fff3cd;color:#856404}.badge-mild{background:#d1ecf1;color:#0c5460}.data-table-module{background:white;border:1px solid var(--hairline-color);border-radius:4px;margin-bottom:20px;overflow:hidden}.data-table-module h2{margin:0;padding:12px 20px;font-weight:500;font-size:15px;background:var(--primary);color:var(--header-link-color)}.data-table-module table{width:100%;border-collapse:collapse}.data-table-module thead{background:var(--darkened-bg)}.data-table-module thead th{padding:10px 15px;text-align:left;font-size:11px;font-weight:600;text-transform:uppercase;color:var(--body-fg);border-bottom:1px solid var(--hairline-color)}.data-table-module tbody td{padding:12px 15px;border-bottom:1px solid var(--hairline-color);font-size:13px}.data-table-module tbody tr:hover{background:var(--darkened-bg)}.data-table-module tbody tr:last-child td{border-bottom:none}.data-table-module .empty{text-align:center;padding:40px 20px;color:#999;font-style:italic}</style><div class="detail-header"><div><h1>{{ patient.full_name }}</h1><div class="meta"><strong>Patient ID:</strong> {{ patient.patient_id }} | <strong>Age:</strong> {{ patient.date_of_birth|timesince|truncatewords:1 }} old</div></div><div class="actions"><a href="{% url 'patient_edit' patient.patient_id %}" class="button" style="color: white;">Edit Patient</a></div></div><div class="quick-access-cards"><a href="{% url 'patient_billing_list' patient.patient_id %}" class="quick-card blue"><div class="quick-card-icon">üíµ</div><div class="quick-card-title">Billing Information</div><div class="quick-card-desc">View billing history</div></a><a href="{% url 'patient_payment_list' patient.patient_id %}" class="quick-card green"><div class="quick-card-icon">üí≥</div><div class="quick-card-title">Payment History</div><div class="quick-card-desc">Track all payments</div></a><a href="{% url 'patient_insurance_list' patient.patient_id %}" class="quick-card purple"><div class="quick-card-icon">üõ°Ô∏è</div><div class="quick-card-title">Insurance Coverage</div><div class="quick-card-desc">View policy details</div></a><a href="{% url 'patient_device_list' patient.patient_id %}" class="quick-card indigo"><div class="quick-card-icon">‚åö</div><div class="quick-card-title">IoT Medical Devices</div><div class="quick-card-desc">Manage connected devices</div></a><a href="{% url 'message_inbox' %}" class="quick-card pink"><div class="quick-card-icon">‚úâÔ∏è</div><div class="quick-card-title">Messages</div><div class="quick-card-desc">Send and receive messages</div></a></div>{% if allergies %}<div class="info-module"><h2>‚ö†Ô∏è Active Allergies</h2><div class="badge-list">{% for allergy in allergies %}<span class="badge-item {% if allergy.severity == 'Severe' %}badge-severe{% elif allergy.severity == 'Moderate' %}badge-moderate{% else %}badge-mild{% endif %}">{{ allergy.allergen }} ({{ allergy.severity }})</span>{% endfor %}</div></div>{% endif %}<div class="info-module"><h2>Patient Information</h2><div class="content"><dl><div><dt>Full Name</dt><dd>{{ patient.full_name }}</dd></div><div><dt>Date of Birth</dt><dd>{{ patient.date_of_birth|date:"F d, Y" }} ({{ patient.date_of_birth|timesince }} ago)</dd></div><div><dt>Gender</dt><dd>{{ patient.gender }}</dd></div><div><dt>Email</dt><dd>{{ patient.email|default:"‚Äî" }}</dd></div><div><dt>Phone</dt><dd>{{ patient.phone|default:"‚Äî" }}</dd></div><div><dt>Address</dt><dd>{% if patient.address %}{{ patient.address }}<br>{{ patient.city }}, {{ patient.state }} {{ patient.zip_code }}{% else %}‚Äî{% endif %}</dd></div><div><dt>Insurance Provider</dt><dd>{{ patient.insurance_provider|default:"‚Äî" }}</dd></div><div><dt>Policy Number</dt><dd>{{ patient.insurance_policy_number|default:"‚Äî" }}</dd></div></dl></div></div><div class="data-table-module"><h2>Recent Appointments</h2>{% if encounters %}<table><thead><tr><th>Date & Time</th><th>Physician</th><th>Type</th><th>Status</th><th>Actions</th></tr></thead><tbody>{% for encounter in encounters %}<tr><td>{{ encounter.encounter_date|date:"M d, Y H:i" }}</td><td>{% if encounter.provider %}Dr. {{ encounter.provider.full_name }}{% else %}‚Äî{% endif %}</td><td>{{ encounter.encounter_type }}</td><td><span class="status-badge status-{{ encounter.status|lower|cut:' ' }}">{{ encounter.status }}</span></td><td><a href="{% url 'appointment_detail' encounter.encounter_id %}" style="color:var(--link-fg);font-weight:500">View</a></td></tr>{% endfor %}</tbody></table>{% else %}<div class="empty">No appointments found</div>{% endif %}</div><div class="data-table-module"><h2>Active Prescriptions</h2>{% if prescriptions %}<table><thead><tr><th>Medication</th><th>Dosage</th><th>Frequency</th><th>Start Date</th><th>Status</th></tr></thead><tbody>{% for prescription in prescriptions %}<tr><td><strong>{{ prescription.medication_name }}</strong></td><td>{{ prescription.dosage }}</td><td>{{ prescription.frequency }}</td><td>{{ prescription.start_date|date:"M d, Y" }}</td><td><span class="status-badge status-{{ prescription.status|lower }}">{{ prescription.status }}</span></td></tr>{% endfor %}</tbody></table>{% else %}<div class="empty">No prescriptions found</div>{% endif %}</div>{% endblock %}
