{% extends 'healthcare/base.html' %}
{% block title %}{{ patient.full_name }} - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; <a href="{% url 'patient_list' %}">Patients</a> &rsaquo; {{ patient.full_name }}{% endblock %}
{% block content %}<style>.detail-header{background:white;border:1px solid var(--hairline-color);border-radius:4px;padding:20px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.detail-header h1{margin:0;font-size:28px;font-weight:300}.detail-header .meta{font-size:13px;color:#666;margin-top:8px}.detail-header .actions{display:flex;gap:10px}.info-module{background:white;border:1px solid var(--hairline-color);border-radius:4px;margin-bottom:20px;overflow:hidden}.info-module h2{margin:0;padding:12px 20px;font-weight:500;font-size:15px;background:var(--primary);color:var(--header-link-color)}.info-module .content{padding:0}.info-module dl{margin:0}.info-module dl>div{display:grid;grid-template-columns:200px 1fr;gap:20px;padding:12px 20px;border-bottom:1px solid var(--hairline-color)}.info-module dl>div:nth-child(even){background:var(--darkened-bg)}.info-module dl>div:last-child{border-bottom:none}.info-module dt{font-size:13px;font-weight:600;color:#666}.info-module dd{font-size:13px;color:var(--body-fg);margin:0}.badge-list{display:flex;flex-wrap:wrap;gap:8px;margin:0;padding:15px 20px}.badge-item{display:inline-block;padding:6px 12px;border-radius:12px;font-size:12px;font-weight:600}.badge-severe{background:#f8d7da;color:#721c24}.badge-moderate{background:#fff3cd;color:#856404}.badge-mild{background:#d1ecf1;color:#0c5460}.data-table-module{background:white;border:1px solid var(--hairline-color);border-radius:4px;margin-bottom:20px;overflow:hidden}.data-table-module h2{margin:0;padding:12px 20px;font-weight:500;font-size:15px;background:var(--primary);color:var(--header-link-color)}.data-table-module table{width:100%;border-collapse:collapse}.data-table-module thead{background:var(--darkened-bg)}.data-table-module thead th{padding:10px 15px;text-align:left;font-size:11px;font-weight:600;text-transform:uppercase;color:var(--body-fg);border-bottom:1px solid var(--hairline-color)}.data-table-module tbody td{padding:12px 15px;border-bottom:1px solid var(--hairline-color);font-size:13px}.data-table-module tbody tr:hover{background:var(--darkened-bg)}.data-table-module tbody tr:last-child td{border-bottom:none}.data-table-module .empty{text-align:center;padding:40px 20px;color:#999;font-style:italic}</style><div class="detail-header"><div><h1>{{ patient.full_name }}</h1><div class="meta"><strong>Patient ID:</strong> {{ patient.patient_id }} | <strong>Age:</strong> {{ patient.date_of_birth|timesince|truncatewords:1 }} old</div></div><div class="actions"><a href="{% url 'patient_edit' patient.patient_id %}" class="button" style="color: white;">Edit Patient</a></div></div>{% if allergies %}<div class="info-module"><h2>⚠️ Active Allergies</h2><div class="badge-list">{% for allergy in allergies %}<span class="badge-item {% if allergy.severity == 'Severe' %}badge-severe{% elif allergy.severity == 'Moderate' %}badge-moderate{% else %}badge-mild{% endif %}">{{ allergy.allergen }} ({{ allergy.severity }})</span>{% endfor %}</div></div>{% endif %}<div class="info-module"><h2>Patient Information</h2><div class="content"><dl><div><dt>Full Name</dt><dd>{{ patient.full_name }}</dd></div><div><dt>Date of Birth</dt><dd>{{ patient.date_of_birth|date:"F d, Y" }} ({{ patient.date_of_birth|timesince }} ago)</dd></div><div><dt>Gender</dt><dd>{{ patient.gender }}</dd></div><div><dt>Email</dt><dd>{{ patient.email|default:"—" }}</dd></div><div><dt>Phone</dt><dd>{{ patient.phone|default:"—" }}</dd></div><div><dt>Address</dt><dd>{% if patient.address %}{{ patient.address }}<br>{{ patient.city }}, {{ patient.state }} {{ patient.zip_code }}{% else %}—{% endif %}</dd></div><div><dt>Insurance Provider</dt><dd>{{ patient.insurance_provider|default:"—" }}</dd></div><div><dt>Policy Number</dt><dd>{{ patient.insurance_policy_number|default:"—" }}</dd></div></dl></div></div><div class="data-table-module"><h2>Recent Appointments</h2>{% if encounters %}<table><thead><tr><th>Date & Time</th><th>Physician</th><th>Type</th><th>Status</th><th>Actions</th></tr></thead><tbody>{% for encounter in encounters %}<tr><td>{{ encounter.encounter_date|date:"M d, Y H:i" }}</td><td>{% if encounter.provider %}Dr. {{ encounter.provider.full_name }}{% else %}—{% endif %}</td><td>{{ encounter.encounter_type }}</td><td><span class="status-badge status-{{ encounter.status|lower|cut:' ' }}">{{ encounter.status }}</span></td><td><a href="{% url 'appointment_detail' encounter.encounter_id %}" style="color:var(--link-fg);font-weight:500">View</a></td></tr>{% endfor %}</tbody></table>{% else %}<div class="empty">No appointments found</div>{% endif %}</div><div class="data-table-module"><h2>Active Prescriptions</h2>{% if prescriptions %}<table><thead><tr><th>Medication</th><th>Dosage</th><th>Frequency</th><th>Start Date</th><th>Status</th></tr></thead><tbody>{% for prescription in prescriptions %}<tr><td><strong>{{ prescription.medication_name }}</strong></td><td>{{ prescription.dosage }}</td><td>{{ prescription.frequency }}</td><td>{{ prescription.start_date|date:"M d, Y" }}</td><td><span class="status-badge status-{{ prescription.status|lower }}">{{ prescription.status }}</span></td></tr>{% endfor %}</tbody></table>{% else %}<div class="empty">No prescriptions found</div>{% endif %}</div>{% endblock %}
