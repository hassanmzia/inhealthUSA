{% extends 'healthcare/base.html' %}
{% block title %}Edit Allergy - InHealth EHR{% endblock %}
{% block breadcrumbs %}&rsaquo; <a href="{% url 'patient_list' %}">Patients</a> &rsaquo; <a href="{% url 'patient_detail' patient.patient_id %}">{{ patient.full_name }}</a> &rsaquo; <a href="{% url 'patient_edit' patient.patient_id %}">Edit</a> &rsaquo; Edit Allergy{% endblock %}
{% block content %}{% include 'healthcare/includes/form_styles.html' %}<div class="form-container"><div class="form-header"><h1>Edit Allergy</h1><div class="meta"><strong>Patient:</strong> {{ patient.full_name }} | <strong>Allergen:</strong> {{ allergy.allergen }}</div></div><div class="module form-module"><h2>Allergy Information</h2><div class="form-content"><form method="POST">{% csrf_token %}<div class="form-row full-width"><div class="form-group"><label class="required">Allergen</label><input type="text" name="allergen" value="{{ allergy.allergen }}" required></div></div><div class="form-row"><div class="form-group"><label>Allergy Type</label><select name="allergy_type"><option value="">Select Type</option><option value="Drug" {% if allergy.allergy_type == 'Drug' %}selected{% endif %}>Drug/Medication</option><option value="Food" {% if allergy.allergy_type == 'Food' %}selected{% endif %}>Food</option><option value="Environmental" {% if allergy.allergy_type == 'Environmental' %}selected{% endif %}>Environmental</option><option value="Other" {% if allergy.allergy_type == 'Other' %}selected{% endif %}>Other</option></select></div><div class="form-group"><label>Severity</label><select name="severity"><option value="">Select Severity</option><option value="Mild" {% if allergy.severity == 'Mild' %}selected{% endif %}>Mild</option><option value="Moderate" {% if allergy.severity == 'Moderate' %}selected{% endif %}>Moderate</option><option value="Severe" {% if allergy.severity == 'Severe' %}selected{% endif %}>Severe</option></select></div><div class="form-group"><label>Onset Date</label><input type="date" name="onset_date" value="{% if allergy.onset_date %}{{ allergy.onset_date|date:'Y-m-d' }}{% endif %}"></div></div><div class="form-row full-width"><div class="form-group"><label>Reaction</label><textarea name="reaction" rows="2">{{ allergy.reaction|default:'' }}</textarea></div></div><div class="form-row full-width"><div class="form-group"><label>Notes</label><textarea name="notes" rows="3">{{ allergy.notes|default:'' }}</textarea></div></div><div class="form-row full-width"><div class="checkbox-group"><input type="checkbox" name="is_active" value="true" {% if allergy.is_active %}checked{% endif %} id="is_active"><label for="is_active">Active Allergy</label></div></div><div class="submit-row"><div></div><div class="buttons-right"><a href="{% url 'patient_edit' patient.patient_id %}" class="button-secondary">Cancel</a><button type="submit" class="button-primary">Update Allergy</button></div></div></form></div></div></div>{% endblock %}
